<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:dyce="clr-namespace:DyCE;assembly=DyCE"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" 
		xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
		xmlns:local="clr-namespace:DyCE_Sandbox"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
		x:Class="DyCE_Sandbox.MainWindow"
        Title="{Binding WindowName, Mode=OneWay}" Icon="Application.ico">
	<Window.Resources>
      <HierarchicalDataTemplate DataType= "{x:Type dyce:EngineBase}" ItemsSource="{Binding SubEngines}">
        <TextBlock Text="{Binding Name}"/>
      </HierarchicalDataTemplate>
	</Window.Resources>
	<Window.DataContext>
		<Binding Source="{StaticResource ViewModelDataSource}"/>
	</Window.DataContext>
    <Grid DataContext="{Binding Source={StaticResource DyCEBagDataSource}}">
    	<Grid.ColumnDefinitions>
    		<ColumnDefinition Width="25*"/>
    		<ColumnDefinition Width="51*"/>
    	</Grid.ColumnDefinitions>
    	<TreeView x:Name="treeView" ItemsSource="{Binding Instance.DyCEList}" Margin="0,0,5,0">
    		<i:Interaction.Behaviors>
    			<local:BindableSelectedItemBehavior SelectedItem="{Binding Instance.SelectedEngine, Mode=TwoWay}"/>
    		</i:Interaction.Behaviors>
    	</TreeView>
        <GridSplitter Width="5"/>
        <ContentControl Grid.Column="1" Content="{Binding Instance.SelectedEngine}">
        	<ContentControl.Resources>
        		<HierarchicalDataTemplate DataType= "{x:Type dyce:EngineText}" ItemsSource="{Binding SubEngines}">
        			<Grid Grid.IsSharedSizeScope="True">
        				<Grid.RowDefinitions>
        					<RowDefinition Height="Auto"/>
							<RowDefinition/>
						</Grid.RowDefinitions>
        					<TextBlock Text="Template Text:" Margin="2"/>
        					<TextBox Text="{Binding Text}" Grid.Row="1" MinWidth="150" Margin="2" AcceptsReturn="True" TextWrapping="Wrap" AutoWordSelection="True" VerticalScrollBarVisibility="Auto"/>
        				</Grid>
        		</HierarchicalDataTemplate>
        		<HierarchicalDataTemplate DataType= "{x:Type dyce:EngineProperty}" ItemsSource="{Binding SubEngines}">
        			<StackPanel Grid.IsSharedSizeScope="True">
        				<Grid Visibility="Visible">
        					<Grid.ColumnDefinitions>
        						<ColumnDefinition Width="Auto" SharedSizeGroup="Label"/>
        						<ColumnDefinition/>
        					</Grid.ColumnDefinitions>
        					<TextBlock Text="Name:" HorizontalAlignment="Right" Margin="2" VerticalAlignment="Center"/>
        					<TextBox Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="9" MinWidth="150" Margin="2"/>
        				</Grid>
        				<Grid Grid.Row="1">
        					<Grid.ColumnDefinitions>
        						<ColumnDefinition Width="Auto" SharedSizeGroup="Label"/>
        						<ColumnDefinition/>
        					</Grid.ColumnDefinitions>
        					<TextBlock Text="Engine" HorizontalAlignment="Right" Margin="2,3,2,2" VerticalAlignment="Top"/>
        					<ComboBox Grid.Column="9" MinWidth="150" Margin="2" ItemsSource="{Binding Instance.DyCEList, Source={StaticResource DyCEBagDataSource}}" SelectedItem="{Binding ValueEngine}"/>
        				</Grid>
        			</StackPanel>
        		</HierarchicalDataTemplate>
        	</ContentControl.Resources>
        </ContentControl>
    </Grid>
</Window>
